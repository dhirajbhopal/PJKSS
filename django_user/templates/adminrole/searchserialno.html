{% extends 'base.html' %}
{% load static %}
{% block title %}Search Serial No{% endblock title %}
{% block forgot %}  {% endblock %}
{% block content %} 
{% if request.user.is_authenticated %}
{% if user.role == "Admin" %}
<script type="text/javascript" src="{% static 'jquery.js' %}"></script>

<div class="container-fluid">
  <button class="btn btn-outline-danger m-3" onclick="history.back()">Go Back</button>
  <form action='searchserialno' method="POST" name="f1" onsubmit="return validation();">
      {% csrf_token %}
  <span style="margin:20px;"> Serial No </span> <input type="text" name="serialno" style="margin:10px;">
<button  class="btn btn-info btn-outline-danger" style="color:black; font-size:15px;">Search</button>
<a href="searchserialnoall"class="btn btn-outline-danger m-3"  style="color:black; font-size:15px;">View All</a>
</form>


<style>
.showmarks {
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
  border: 3px solid green;
}

.td1 {
  text-align:center;
  border: 1px solid red;"
}

#dwnldBtn{
            background-color: green; 
            color: #fff; 
            padding: 10px; 
            border: none;
            border-radius: 5px; 
            margin: 2rem 0;
            cursor: pointer;
        }

</style>
{% for i in serial %}

<table class="showmarks" id="myTable" class="table-bordered container-fluid" align="center">
      <tr class="td1" border="1px" align="center" style="background-color:black; color:white;"> 
                      <th class="td1">Serial No</th>
                      <th class="td1">Letter Head Person Name</th>
                      <th class="td1">Issue To</th>
                      <th class="td1">Subject</th>
                      <th class="td1">Date</th>
                      <th class="td1">Action</th>
                    </tr>
                      <tr class="td1" align="center">
                      <td class="td1"><input type="text" style="background-color:transparent; border:none; " id="barcodeInput" disabled value={{i.code}}></td>
                      <td class="td1">{{i.issuername}}</td>  
                       <td class="td1">{{i.issuedto}}</td>
                        <td class="td1">{{i.subject}}</td>
                        <td class="td1">{{i.issuedate}}</td>
                      <td> <form action="editserialno" method="GET">
                          {% csrf_token %}
                          <input type="hidden" name="serialno" value="{{i.code}}">
                    <button class="btn btn-success btn-outline-warning ">Edit</button>
                   </form></td>
                      </tr> 
                    </table> 
                    <div id="printableArea"><svg id="barcode"></svg></div>
                    <button class="btn btn-success btn-outline-warning m-2" onclick="printDiv('printableArea')">Print</button>
                    <button class="btn btn-success btn-outline-warning m-2" onclick="generateBarcode()">Bar Code</button>
                   {% endfor %}
                    

<script type="text/javascript">
function validation() 
  { 
    var serialno=document.f1.serialno.value;

    if(serialno=="")
      {
      alert("Please Enter Roll No");
      return false;
    }

}
  </script>
<script type="text/javascript">
function printDiv(divId) {
    // Get the HTML content of the div
    var divContents = document.getElementById(divId).innerHTML;

    // Open a new popup window
    var printWindow = window.open('', '', 'height=600,width=800');

    // Write the div contents into the new window
    printWindow.document.write('<html><head><title>Letter Head</title>');
    printWindow.document.write('</head><body> <br> <br><br><br><br><br><br><br><br><br><br><br><br>  &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 &#160 ');
    printWindow.document.write(divContents);
    printWindow.document.write('</body></html>');

    printWindow.document.close(); // Close the document
    printWindow.print(); // Trigger print dialog
}
</script>
<script type="text/javascript">
        function generateBarcode() {
            var text = document.getElementById("barcodeInput").value;
            if (text) { // Only generate if there's text
                JsBarcode("#barcode", text, {
                    format: "CODE128", // You can change this to other formats like "CODE39", "EAN13", "QRCODE", etc.
                    displayValue: true, // Shows the text below the barcode
                    height: 40,
                    width: 1
                });
            } else {
                alert("Please enter some text to generate a barcode.");
            }
        }
    </script>

{% block sms %} {% endblock %}
   {% if messages %}
    {% for message in messages %}
        <span style="color: red; margin-left: 20px;"><i class="fa fa-exclamation-triangle" aria-hidden="true" style='font-size:30px;color:red;margin-top: 10px;"'></i>{{message}}</span>
    {% endfor %}
{% endif %}
</div>
                  
{% else %}
<h1> You Do Not Have permission to access this page</h1>
{% endif %}
 {% else %}
 <h1> You are not logged in</h1>
    {% endif %} 
               {% endblock %}
               {% block mainbody %} {% endblock %}